<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
<meta name="generator" content="pdoc3 0.11.1">
<title>ukat.utils.tests.test_arraystats API documentation</title>
<meta name="description" content="">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/sanitize.min.css" integrity="sha512-y1dtMcuvtTMJc1yPgEqF0ZjQbhnc/bFhyvIyVNb9Zk5mIGtqVaAB1Ttl28su8AvFMOY0EwRbAe+HCLqj6W7/KA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/13.0.0/typography.min.css" integrity="sha512-Y1DYSb995BAfxobCkKepB1BqJJTPrOp3zPL74AWFugHHmmdcvO+C48WLrUOlhGMc0QG7AE3f7gmvvcrmX2fDoA==" crossorigin>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:1.5em;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:2em 0 .50em 0}h3{font-size:1.4em;margin:1.6em 0 .7em 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .2s ease-in-out}a:visited{color:#503}a:hover{color:#b62}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900;font-weight:bold}pre code{font-size:.8em;line-height:1.4em;padding:1em;display:block}code{background:#f3f3f3;font-family:"DejaVu Sans Mono",monospace;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em 1em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul ul{padding-left:1em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha512-D9gUyxqja7hBtkWpPWGt9wfbfaMGVt9gnyCvYa+jojwwPHLCzUm5i8rpk7vD7wNee9bA35eYIjobYPaQuKS1MQ==" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => {
hljs.configure({languages: ['bash', 'css', 'diff', 'graphql', 'ini', 'javascript', 'json', 'plaintext', 'python', 'python-repl', 'rust', 'shell', 'sql', 'typescript', 'xml', 'yaml']});
hljs.highlightAll();
})</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>ukat.utils.tests.test_arraystats</code></h1>
</header>
<section id="section-intro">
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="ukat.utils.tests.test_arraystats.calc_stats"><code class="name flex">
<span>def <span class="ident">calc_stats</span></span>(<span>x)</span>
</code></dt>
<dd>
<div class="desc"><p>Gold standard (gs) implementation of calculation of statistical measures.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>x</code></strong> :&ensp;<code>np.ndarray with 1 dimension</code></dt>
<dd>&nbsp;</dd>
</dl>
<h2 id="notes">Notes</h2>
<p>This is defined at the module level as it is used by both test Classes.</p></div>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats"><code class="flex name class">
<span>class <span class="ident">TestArrayStats</span></span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TestArrayStats:

    # Good arrays
    array_4D = np.nan*np.ones((3, 3, 2, 2))
    array_4D[:, :, 0, 0] = np.array([[4, 8, -1.2], [-4.8, 4, 2], [-3, 0, 5.0]])
    array_4D[:, :, 0, 1] = np.array([[3, 6, -3.7], [-3.1, 2, 0], [-4, 4, 4.3]])
    array_4D[:, :, 1, 0] = np.array([[2, 4, -2.2], [-1.7, 3, 3], [-2, 3, 3.2]])
    array_4D[:, :, 1, 1] = np.array([[2, 2, -3.8], [-0.9, 4, 5], [-0, 1, 5.0]])

    array_3D = np.nan*np.ones((3, 3, 2))
    array_3D[:, :, 0] = np.array([[3, 6, -3.7], [-3.1, 2, 0], [-4, 4, 4.3]])
    array_3D[:, :, 1] = np.array([[2, 4, -2.2], [-1.7, 3, 3], [-2, 3, 3.2]])

    array_2D = np.array([[3, 6, -3.7], [-3.1, 2, 0], [-4, 4, 4.3]])

    # Bad arrays
    array_5D = np.ones((2, 2, 2, 2, 2))
    array_1D = np.array([1])

    def test_4D_without_roi(self):
        # Calculate stats using ArrayStats
        stats = ast.ArrayStats(self.array_4D).calculate()

        # Calculate &#34;gold standard&#34; (gs) stats
        gs_4D = calc_stats(self.array_4D.flatten())
        gs_3D_0 = calc_stats(self.array_4D[:, :, :, 0].flatten())
        gs_3D_1 = calc_stats(self.array_4D[:, :, :, 1].flatten())
        gs_2D_0 = calc_stats(self.array_4D[:, :, 0, 0].flatten())
        gs_2D_1 = calc_stats(self.array_4D[:, :, 0, 1].flatten())
        gs_2D_2 = calc_stats(self.array_4D[:, :, 1, 0].flatten())
        gs_2D_3 = calc_stats(self.array_4D[:, :, 1, 1].flatten())

        gs_list = [gs_4D, gs_3D_0, gs_3D_1, gs_2D_0, gs_2D_1, gs_2D_2, gs_2D_3]

        # Perform tests without ROI
        self.group_tests_4D(stats, gs_list)

    def test_4D_with_roi(self):
        # &#34;Random&#34; ROI
        roi_4D = np.ones((3, 3, 2, 2), dtype=bool)
        roi_4D[:, :, 0, 0] = np.array([[0, 0, 0], [1, 1, 1], [0, 0, 0]])
        roi_4D[:, :, 0, 1] = np.array([[1, 0, 0], [1, 0, 0], [1, 0, 0]])
        roi_4D[:, :, 1, 0] = np.array([[0, 1, 1], [0, 0, 0], [0, 0, 0]])
        roi_4D[:, :, 1, 1] = np.array([[1, 1, 0], [1, 0, 0], [0, 0, 1]])

        # Calculate stats using ArrayStats
        stats_roi = ast.ArrayStats(self.array_4D, roi=roi_4D).calculate()

        # Calculate &#34;gold standard&#34; (gs) stats
        gs_4D_roi = calc_stats(self.array_4D[roi_4D])
        gs_3D_roi_0 = calc_stats(self.array_4D[:, :, :, 0][roi_4D[:, :, :, 0]])
        gs_3D_roi_1 = calc_stats(self.array_4D[:, :, :, 1][roi_4D[:, :, :, 1]])
        gs_2D_roi_0 = calc_stats(self.array_4D[:, :, 0, 0][roi_4D[:, :, 0, 0]])
        gs_2D_roi_1 = calc_stats(self.array_4D[:, :, 0, 1][roi_4D[:, :, 0, 1]])
        gs_2D_roi_2 = calc_stats(self.array_4D[:, :, 1, 0][roi_4D[:, :, 1, 0]])
        gs_2D_roi_3 = calc_stats(self.array_4D[:, :, 1, 1][roi_4D[:, :, 1, 1]])

        gs_list_roi = [gs_4D_roi, gs_3D_roi_0, gs_3D_roi_1,
                       gs_2D_roi_0, gs_2D_roi_1, gs_2D_roi_2, gs_2D_roi_3]

        # Perform tests with ROI
        self.group_tests_4D(stats_roi, gs_list_roi)

    def group_tests_4D(self, stats, gs_list):
        &#34;&#34;&#34;
        Perform tests that compare outputs of ArrayStats.calculate() and the
        calc_stats() function above.

        Notes
        -----
        This is used by tests with and without ROI so it was abstracted in its
        own function
        &#34;&#34;&#34;

        # Unpack list
        [gs_4D, gs_3D_0, gs_3D_1, gs_2D_0, gs_2D_1, gs_2D_2, gs_2D_3] = gs_list

        # Group gs stats to compare with output from ArrayStats
        gs_n_4D = gs_4D[0]
        gs_mean_4D = gs_4D[1]
        gs_median_4D = gs_4D[2]
        gs_minimum_4D = gs_4D[3]
        gs_maximum_4D = gs_4D[4]
        gs_std_4D = gs_4D[5]
        gs_cv_4D = gs_4D[6]
        gs_skewness_4D = gs_4D[7]
        gs_kurtosis_4D = gs_4D[8]
        gs_entropy_4D = gs_4D[9]

        gs_n_3D = np.array([gs_3D_0[0], gs_3D_1[0]])
        gs_mean_3D = np.array([gs_3D_0[1], gs_3D_1[1]])
        gs_median_3D = np.array([gs_3D_0[2], gs_3D_1[2]])
        gs_minimum_3D = np.array([gs_3D_0[3], gs_3D_1[3]])
        gs_maximum_3D = np.array([gs_3D_0[4], gs_3D_1[4]])
        gs_std_3D = np.array([gs_3D_0[5], gs_3D_1[5]])
        gs_cv_3D = np.array([gs_3D_0[6], gs_3D_1[6]])
        gs_skewness_3D = np.array([gs_3D_0[7], gs_3D_1[7]])
        gs_kurtosis_3D = np.array([gs_3D_0[8], gs_3D_1[8]])
        gs_entropy_3D = np.array([gs_3D_0[9], gs_3D_1[9]])

        gs_n_2D = np.array([[gs_2D_0[0], gs_2D_1[0]],
                            [gs_2D_2[0], gs_2D_3[0]]])
        gs_mean_2D = np.array([[gs_2D_0[1], gs_2D_1[1]],
                               [gs_2D_2[1], gs_2D_3[1]]])
        gs_median_2D = np.array([[gs_2D_0[2], gs_2D_1[2]],
                                 [gs_2D_2[2], gs_2D_3[2]]])
        gs_minimum_2D = np.array([[gs_2D_0[3], gs_2D_1[3]],
                                  [gs_2D_2[3], gs_2D_3[3]]])
        gs_maximum_2D = np.array([[gs_2D_0[4], gs_2D_1[4]],
                                  [gs_2D_2[4], gs_2D_3[4]]])
        gs_std_2D = np.array([[gs_2D_0[5], gs_2D_1[5]],
                              [gs_2D_2[5], gs_2D_3[5]]])
        gs_cv_2D = np.array([[gs_2D_0[6], gs_2D_1[6]],
                             [gs_2D_2[6], gs_2D_3[6]]])
        gs_skewness_2D = np.array([[gs_2D_0[7], gs_2D_1[7]],
                                   [gs_2D_2[7], gs_2D_3[7]]])
        gs_kurtosis_2D = np.array([[gs_2D_0[8], gs_2D_1[8]],
                                   [gs_2D_2[8], gs_2D_3[8]]])
        gs_entropy_2D = np.array([[gs_2D_0[9], gs_2D_1[9]],
                                  [gs_2D_2[9], gs_2D_3[9]]])

        # Tests
        npt.assert_allclose(stats[&#34;n&#34;][&#34;4D&#34;], gs_n_4D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;mean&#34;][&#34;4D&#34;], gs_mean_4D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;median&#34;][&#34;4D&#34;], gs_median_4D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;min&#34;][&#34;4D&#34;], gs_minimum_4D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;max&#34;][&#34;4D&#34;], gs_maximum_4D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;std&#34;][&#34;4D&#34;], gs_std_4D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;cv&#34;][&#34;4D&#34;], gs_cv_4D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;skewness&#34;][&#34;4D&#34;], gs_skewness_4D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;kurtosis&#34;][&#34;4D&#34;], gs_kurtosis_4D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;entropy&#34;][&#34;4D&#34;], gs_entropy_4D, rtol=1e-6)

        npt.assert_allclose(stats[&#34;n&#34;][&#34;3D&#34;], gs_n_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;mean&#34;][&#34;3D&#34;], gs_mean_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;median&#34;][&#34;3D&#34;], gs_median_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;min&#34;][&#34;3D&#34;], gs_minimum_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;max&#34;][&#34;3D&#34;], gs_maximum_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;std&#34;][&#34;3D&#34;], gs_std_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;cv&#34;][&#34;3D&#34;], gs_cv_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;skewness&#34;][&#34;3D&#34;], gs_skewness_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;kurtosis&#34;][&#34;3D&#34;], gs_kurtosis_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;entropy&#34;][&#34;3D&#34;], gs_entropy_3D, rtol=1e-6)

        npt.assert_allclose(stats[&#34;n&#34;][&#34;2D&#34;], gs_n_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;mean&#34;][&#34;2D&#34;], gs_mean_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;median&#34;][&#34;2D&#34;], gs_median_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;min&#34;][&#34;2D&#34;], gs_minimum_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;max&#34;][&#34;2D&#34;], gs_maximum_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;std&#34;][&#34;2D&#34;], gs_std_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;cv&#34;][&#34;2D&#34;], gs_cv_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;skewness&#34;][&#34;2D&#34;], gs_skewness_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;kurtosis&#34;][&#34;2D&#34;], gs_kurtosis_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;entropy&#34;][&#34;2D&#34;], gs_entropy_2D, rtol=1e-6)

    def test_3D_without_roi(self):
        # Calculate stats using ArrayStats
        stats = ast.ArrayStats(self.array_3D).calculate()

        # Calculate &#34;gold standard&#34; (gs) stats
        gs_3D = calc_stats(self.array_3D.flatten())
        gs_2D_0 = calc_stats(self.array_3D[:, :, 0].flatten())
        gs_2D_1 = calc_stats(self.array_3D[:, :, 1].flatten())

        # Group gs stats to compare with output from ArrayStats
        gs_n_3D = gs_3D[0]
        gs_mean_3D = gs_3D[1]
        gs_median_3D = gs_3D[2]
        gs_minimum_3D = gs_3D[3]
        gs_maximum_3D = gs_3D[4]
        gs_std_3D = gs_3D[5]
        gs_cv_3D = gs_3D[6]
        gs_skewness_3D = gs_3D[7]
        gs_kurtosis_3D = gs_3D[8]
        gs_entropy_3D = gs_3D[9]

        gs_n_2D = np.array([gs_2D_0[0], gs_2D_1[0]])
        gs_mean_2D = np.array([gs_2D_0[1], gs_2D_1[1]])
        gs_median_2D = np.array([gs_2D_0[2], gs_2D_1[2]])
        gs_minimum_2D = np.array([gs_2D_0[3], gs_2D_1[3]])
        gs_maximum_2D = np.array([gs_2D_0[4], gs_2D_1[4]])
        gs_std_2D = np.array([gs_2D_0[5], gs_2D_1[5]])
        gs_cv_2D = np.array([gs_2D_0[6], gs_2D_1[6]])
        gs_skewness_2D = np.array([gs_2D_0[7], gs_2D_1[7]])
        gs_kurtosis_2D = np.array([gs_2D_0[8], gs_2D_1[8]])
        gs_entropy_2D = np.array([gs_2D_0[9], gs_2D_1[9]])

        npt.assert_allclose(stats[&#34;n&#34;][&#34;3D&#34;], gs_n_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;mean&#34;][&#34;3D&#34;], gs_mean_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;median&#34;][&#34;3D&#34;], gs_median_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;min&#34;][&#34;3D&#34;], gs_minimum_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;max&#34;][&#34;3D&#34;], gs_maximum_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;std&#34;][&#34;3D&#34;], gs_std_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;cv&#34;][&#34;3D&#34;], gs_cv_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;skewness&#34;][&#34;3D&#34;], gs_skewness_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;kurtosis&#34;][&#34;3D&#34;], gs_kurtosis_3D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;entropy&#34;][&#34;3D&#34;], gs_entropy_3D, rtol=1e-6)

        npt.assert_allclose(stats[&#34;n&#34;][&#34;2D&#34;], gs_n_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;mean&#34;][&#34;2D&#34;], gs_mean_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;median&#34;][&#34;2D&#34;], gs_median_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;min&#34;][&#34;2D&#34;], gs_minimum_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;max&#34;][&#34;2D&#34;], gs_maximum_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;std&#34;][&#34;2D&#34;], gs_std_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;cv&#34;][&#34;2D&#34;], gs_cv_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;skewness&#34;][&#34;2D&#34;], gs_skewness_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;kurtosis&#34;][&#34;2D&#34;], gs_kurtosis_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;entropy&#34;][&#34;2D&#34;], gs_entropy_2D, rtol=1e-6)

    def test_2D_without_roi(self):
        # Calculate stats using ArrayStats
        stats = ast.ArrayStats(self.array_2D).calculate()

        # Calculate &#34;gold standard&#34; (gs) stats
        gs_2D = calc_stats(self.array_2D.flatten())

        # Group gs stats to compare with output from ArrayStats
        gs_n_2D = gs_2D[0]
        gs_mean_2D = gs_2D[1]
        gs_median_2D = gs_2D[2]
        gs_minimum_2D = gs_2D[3]
        gs_maximum_2D = gs_2D[4]
        gs_std_2D = gs_2D[5]
        gs_cv_2D = gs_2D[6]
        gs_skewness_2D = gs_2D[7]
        gs_kurtosis_2D = gs_2D[8]
        gs_entropy_2D = gs_2D[9]

        npt.assert_allclose(stats[&#34;n&#34;], gs_n_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;mean&#34;], gs_mean_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;median&#34;], gs_median_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;min&#34;], gs_minimum_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;max&#34;], gs_maximum_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;std&#34;], gs_std_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;cv&#34;], gs_cv_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;skewness&#34;], gs_skewness_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;kurtosis&#34;], gs_kurtosis_2D, rtol=1e-6)
        npt.assert_allclose(stats[&#34;entropy&#34;], gs_entropy_2D, rtol=1e-6)

    def test_bad_array_dimensions(self):
        with pytest.raises(ValueError):
            ast.ArrayStats(self.array_1D)

        with pytest.raises(ValueError):
            ast.ArrayStats(self.array_5D)

    def test_bad_roi_dtype(self):
        array = np.ones((3, 3, 2))
        roi = np.ones((3, 3, 2))
        with pytest.raises(TypeError):
            ast.ArrayStats(array, roi)

    def test_roi_shape_mismatch(self):
        array = np.ones((3, 3, 2))
        roi = np.ones((3, 3, 3), dtype=bool)
        with pytest.raises(ValueError):
            ast.ArrayStats(array, roi)</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.array_1D"><code class="name">var <span class="ident">array_1D</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.array_2D"><code class="name">var <span class="ident">array_2D</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.array_3D"><code class="name">var <span class="ident">array_3D</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.array_4D"><code class="name">var <span class="ident">array_4D</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.array_5D"><code class="name">var <span class="ident">array_5D</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.group_tests_4D"><code class="name flex">
<span>def <span class="ident">group_tests_4D</span></span>(<span>self, stats, gs_list)</span>
</code></dt>
<dd>
<div class="desc"><p>Perform tests that compare outputs of ArrayStats.calculate() and the
calc_stats() function above.</p>
<h2 id="notes">Notes</h2>
<p>This is used by tests with and without ROI so it was abstracted in its
own function</p></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.test_2D_without_roi"><code class="name flex">
<span>def <span class="ident">test_2D_without_roi</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.test_3D_without_roi"><code class="name flex">
<span>def <span class="ident">test_3D_without_roi</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.test_4D_with_roi"><code class="name flex">
<span>def <span class="ident">test_4D_with_roi</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.test_4D_without_roi"><code class="name flex">
<span>def <span class="ident">test_4D_without_roi</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.test_bad_array_dimensions"><code class="name flex">
<span>def <span class="ident">test_bad_array_dimensions</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.test_bad_roi_dtype"><code class="name flex">
<span>def <span class="ident">test_bad_roi_dtype</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestArrayStats.test_roi_shape_mismatch"><code class="name flex">
<span>def <span class="ident">test_roi_shape_mismatch</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestFlatStats"><code class="flex name class">
<span>class <span class="ident">TestFlatStats</span></span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TestFlatStats:

    def test_array_with_one_element(self):
        # Note `gs`: gold standard

        # Int
        x1 = np.array([5])
        gs_1 = calc_stats(x1)
        stats_1 = self.flatstats_to_array(ast.FlatStats(x1).calculate())
        npt.assert_allclose(stats_1, gs_1, rtol=1e-6)

        # Float
        x2 = np.array([5.3])
        gs_2 = calc_stats(x2)
        stats_2 = self.flatstats_to_array(ast.FlatStats(x2).calculate())
        npt.assert_allclose(stats_2, gs_2, rtol=1e-6)

        # Negative number
        x3 = np.array([-5.3])
        gs_3 = calc_stats(x3)
        stats_3 = self.flatstats_to_array(ast.FlatStats(x3).calculate())
        npt.assert_allclose(stats_3, gs_3, rtol=1e-6)

        # Zero
        x4 = np.array([0])
        gs_4 = calc_stats(x4)
        stats_4 = self.flatstats_to_array(ast.FlatStats(x4).calculate())
        npt.assert_allclose(stats_4, gs_4, rtol=1e-6, equal_nan=True)

        # Nan
        x5 = np.array([np.nan])
        gs_5 = calc_stats(x5)
        stats_5 = self.flatstats_to_array(ast.FlatStats(x5).calculate())
        npt.assert_allclose(stats_5, gs_5, rtol=1e-6, equal_nan=True)

    def test_array_with_multiple_elements(self):
        # Ints
        x1 = np.array([5, 9, 7, 12, 19])
        gs_1 = calc_stats(x1)
        stats_1 = self.flatstats_to_array(ast.FlatStats(x1).calculate())
        npt.assert_allclose(stats_1, gs_1, rtol=1e-6)

        # Float
        x2 = np.array([5, 9, np.sqrt(7), 12, 19])
        gs_2 = calc_stats(x2)
        stats_2 = self.flatstats_to_array(ast.FlatStats(x2).calculate())
        npt.assert_allclose(stats_2, gs_2, rtol=1e-6)

        # Negative numbers
        x3 = np.array([5, 9, -np.sqrt(7), -12, 19])
        gs_3 = calc_stats(x3)
        stats_3 = self.flatstats_to_array(ast.FlatStats(x3).calculate())
        npt.assert_allclose(stats_3, gs_3, rtol=1e-6)

        # Zero
        x4 = np.array([5, 0, np.sqrt(7), -12, 19])
        gs_4 = calc_stats(x4)
        stats_4 = self.flatstats_to_array(ast.FlatStats(x4).calculate())
        npt.assert_allclose(stats_4, gs_4, rtol=1e-6, equal_nan=True)

        # Nan
        x5 = np.array([5, 0, np.sqrt(7), -12, np.nan])
        gs_5 = calc_stats(x5)
        stats_5 = self.flatstats_to_array(ast.FlatStats(x5).calculate())
        npt.assert_allclose(stats_5, gs_5, rtol=1e-6, equal_nan=True)

    def test_empty_array(self):
        expected_stats = np.array([0,        # n
                                   np.nan,   # mean
                                   np.nan,   # median
                                   np.nan,   # min
                                   np.nan,   # max
                                   np.nan,   # std
                                   np.nan,   # cv
                                   np.nan,   # skewness
                                   np.nan,   # kurtosis
                                   np.nan])  # entropy

        x1 = np.array([])
        stats_1 = self.flatstats_to_array(ast.FlatStats(x1).calculate())
        npt.assert_allclose(stats_1, expected_stats, rtol=1e-6, equal_nan=True)

    def test_nonflat_array(self):
        x1 = None
        with pytest.raises(ValueError):
            ast.FlatStats(x1)

        x2 = np.array([[5, 9], [3, 4]])
        with pytest.raises(ValueError):
            ast.FlatStats(x2)

    def flatstats_to_array(self, fs):
        n = fs.n
        mean = fs.mean
        median = fs.median
        minimum = fs.min
        maximum = fs.max
        std = fs.std
        cv = fs.cv
        skewness = fs.skewness
        kurtosis = fs.kurtosis
        entropy = fs.entropy

        return [n, mean, median, minimum, maximum, std, cv, skewness, kurtosis,
                entropy]</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="ukat.utils.tests.test_arraystats.TestFlatStats.flatstats_to_array"><code class="name flex">
<span>def <span class="ident">flatstats_to_array</span></span>(<span>self, fs)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestFlatStats.test_array_with_multiple_elements"><code class="name flex">
<span>def <span class="ident">test_array_with_multiple_elements</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestFlatStats.test_array_with_one_element"><code class="name flex">
<span>def <span class="ident">test_array_with_one_element</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestFlatStats.test_empty_array"><code class="name flex">
<span>def <span class="ident">test_empty_array</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ukat.utils.tests.test_arraystats.TestFlatStats.test_nonflat_array"><code class="name flex">
<span>def <span class="ident">test_nonflat_array</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="ukat.utils.tests" href="index.html">ukat.utils.tests</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="ukat.utils.tests.test_arraystats.calc_stats" href="#ukat.utils.tests.test_arraystats.calc_stats">calc_stats</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats" href="#ukat.utils.tests.test_arraystats.TestArrayStats">TestArrayStats</a></code></h4>
<ul class="">
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.array_1D" href="#ukat.utils.tests.test_arraystats.TestArrayStats.array_1D">array_1D</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.array_2D" href="#ukat.utils.tests.test_arraystats.TestArrayStats.array_2D">array_2D</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.array_3D" href="#ukat.utils.tests.test_arraystats.TestArrayStats.array_3D">array_3D</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.array_4D" href="#ukat.utils.tests.test_arraystats.TestArrayStats.array_4D">array_4D</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.array_5D" href="#ukat.utils.tests.test_arraystats.TestArrayStats.array_5D">array_5D</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.group_tests_4D" href="#ukat.utils.tests.test_arraystats.TestArrayStats.group_tests_4D">group_tests_4D</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.test_2D_without_roi" href="#ukat.utils.tests.test_arraystats.TestArrayStats.test_2D_without_roi">test_2D_without_roi</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.test_3D_without_roi" href="#ukat.utils.tests.test_arraystats.TestArrayStats.test_3D_without_roi">test_3D_without_roi</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.test_4D_with_roi" href="#ukat.utils.tests.test_arraystats.TestArrayStats.test_4D_with_roi">test_4D_with_roi</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.test_4D_without_roi" href="#ukat.utils.tests.test_arraystats.TestArrayStats.test_4D_without_roi">test_4D_without_roi</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.test_bad_array_dimensions" href="#ukat.utils.tests.test_arraystats.TestArrayStats.test_bad_array_dimensions">test_bad_array_dimensions</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.test_bad_roi_dtype" href="#ukat.utils.tests.test_arraystats.TestArrayStats.test_bad_roi_dtype">test_bad_roi_dtype</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestArrayStats.test_roi_shape_mismatch" href="#ukat.utils.tests.test_arraystats.TestArrayStats.test_roi_shape_mismatch">test_roi_shape_mismatch</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ukat.utils.tests.test_arraystats.TestFlatStats" href="#ukat.utils.tests.test_arraystats.TestFlatStats">TestFlatStats</a></code></h4>
<ul class="">
<li><code><a title="ukat.utils.tests.test_arraystats.TestFlatStats.flatstats_to_array" href="#ukat.utils.tests.test_arraystats.TestFlatStats.flatstats_to_array">flatstats_to_array</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestFlatStats.test_array_with_multiple_elements" href="#ukat.utils.tests.test_arraystats.TestFlatStats.test_array_with_multiple_elements">test_array_with_multiple_elements</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestFlatStats.test_array_with_one_element" href="#ukat.utils.tests.test_arraystats.TestFlatStats.test_array_with_one_element">test_array_with_one_element</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestFlatStats.test_empty_array" href="#ukat.utils.tests.test_arraystats.TestFlatStats.test_empty_array">test_empty_array</a></code></li>
<li><code><a title="ukat.utils.tests.test_arraystats.TestFlatStats.test_nonflat_array" href="#ukat.utils.tests.test_arraystats.TestFlatStats.test_nonflat_array">test_nonflat_array</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.11.1</a>.</p>
</footer>
</body>
</html>
